CREATE database ranti;

use ranti;

-- DROP TABLE IF EXISTS user;
CREATE TABLE user (
    id int(10) NOT NULL AUTO_INCREMENT,
    username varchar(50) NOT NULL,
    password varchar(200) NOT NULL,
    email varchar(200),
    state bool DEFAULT true, -- tinyint(1) DEFAULT 1
    created_at datetime NOT NULL, 
    updated_at datetime NOT NULL,
    PRIMARY KEY(id)
);

-- DROP TABLE IF EXISTS company;
CREATE TABLE company (
    id int(10) NOT NULL AUTO_INCREMENT,
    company_name varchar(100) NOT NULL,
    image varchar(100),
    uri_endpoint varchar(200) NOT NULL,
    state bool DEFAULT true, -- tinyint(1) DEFAULT 1
    created_at datetime NOT NULL, 
    updated_at datetime NOT NULL,
    PRIMARY KEY(id)
);

-- DROP TABLE IF EXISTS user_company;
CREATE TABLE user_company (
    user_id int(10) NOT NULL ,
    company_id int(10) NOT NULL,    
    user_company_id int(10) NOT NULL,
    PRIMARY KEY(user_id,company_id)
    FOREIGN KEY(user_id) REFERENCES user(id),
    FOREIGN KEY(company_id) REFERENCES company(id)
);

/*
ALTER TABLE `ranti`.`user_company` ADD CONSTRAINT `FK_user_company_1` FOREIGN KEY `FK_user_company_1` (`user_id`)
    REFERENCES `user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
 ADD CONSTRAINT `FK_user_company_2` FOREIGN KEY `FK_user_company_2` (`company_id`)
    REFERENCES `company` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION;
*/

-- DROP TABLE IF EXISTS user_company;
CREATE TABLE shopping_history (
    id int(10) NOT NULL AUTO_INCREMENT,
    user_id int(10) NOT NULL ,
    company_id int(10) NOT NULL,    
    amount decimal(12,4),
    created_at datetime NOT NULL, 
    user_company_id int(10) NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY(user_id) REFERENCES user(id),
    FOREIGN KEY(company_id) REFERENCES company(id)
);

/*
-- DROP TABLE IF EXISTS user_company;
CREATE TABLE shopping_history_master (
    id int(10) NOT NULL AUTO_INCREMENT,
    -- datos de compra
    history_id int(10) NOT NULL ,
    company_id int(10) NOT NULL,    
    user_company_id int(10) NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY(history_id) REFERENCES history(id)    
);

-- DROP TABLE IF EXISTS user_company;
CREATE TABLE shopping_history_detail (
    id int(10) NOT NULL AUTO_INCREMENT,
    user_id int(10) NOT NULL ,
    company_id int(10) NOT NULL,    
    user_company_id int(10) NOT NULL,
    PRIMARY KEY(id),
    FOREIGN KEY(user_id) REFERENCES user(id),
    FOREIGN KEY(company_id) REFERENCES company(id)
);
*/

/*
DROP TABLE IF EXISTS user;
CREATE TABLE  user (
  `aco_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `aco_art_id` int(10) unsigned NOT NULL,
  `aco_col_id` int(10) unsigned NOT NULL,
  PRIMARY KEY (`aco_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3;
*/
